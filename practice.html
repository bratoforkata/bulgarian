<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Practice — Bulgarian → English</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="header">
    <div class="brand">Bulgarian → English trainer</div>
    <nav class="tabs">
      <button class="tab" onclick="location.href='index.html'">Welcome</button>
      <button class="tab active">Practice</button>
      <button class="tab" onclick="location.href='dictionary.html'">Dictionary</button>
    </nav>
  </header>

  <main class="container">
    <section class="card">
      <div class="practice-layout">
        <div>
          <div class="word-big" id="word-english">—</div>
          <div class="small-muted" id="word-bulgarian">—</div>
        </div>
        <div class="practice-actions">
          <button id="next" class="btn">Next word</button>
        </div>
      </div>
      <div class="practice-help small-muted">Click Next word to see another word. The Bulgarian translation will appear here.</div>
    </section>

    <section class="card accuracy-section">
      <div class="accuracy-layout">
        <div class="accuracy-meter">
          <div class="accuracy-display">Accuracy: 0%</div>
        </div>
        <div class="feedback-buttons">
          <button id="success-btn" class="btn success-btn" disabled>Success</button>
          <button id="fail-btn" class="btn fail-btn" disabled>Fail</button>
        </div>
      </div>
      <div class="failed-words-section">
        <h3>Failed Words</h3>
        <textarea id="failed-words-list" readonly placeholder="Words you got wrong will appear here..."></textarea>
        <button id="copy-failed-btn" class="btn btn-secondary">Copy Failed Words</button>
      </div>
    </section>
  </main>

<script>
        // Store words array
        let words = [];

        // Accuracy tracking
        let totalAttempts = 0;
        let successes = 0;
        let failedWords = [];

        // Current word being tested
        let currentWord = null;

        // Load words from data.html
        fetch('data.html')
            .then(function(response) {
                return response.text();
            })
            .then(function(html) {
                // Parse the HTML
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const dataElement = doc.getElementById('dictionary-data');
                
                if (!dataElement) {
                    throw new Error('Dictionary data not found in data.html');
                }

                // Parse the words
                const lines = dataElement.textContent.split('\n');
                words = lines
                    .filter(line => line.trim() && line.includes(' - '))
                    .map(line => {
                        const [bul, ...eng] = line.split(' - ');
                        return {
                            bulgarian: bul.trim(),
                            english: eng.join(' - ').trim()
                        };
                    });

                if (words.length === 0) {
                    throw new Error('No words found in data.html');
                }

                console.log('Loaded ' + words.length + ' words');
                showWord();
            })
            .catch(function(error) {
                console.error('Error loading words:', error);
                document.getElementById('word-english').textContent = 'Error loading words';
                document.getElementById('word-bulgarian').textContent = 'Please check data.html';
            });

        // Show a random word
        function showWord() {
            if (words.length === 0) {
                return;
            }

            const index = Math.floor(Math.random() * words.length);
            currentWord = words[index];

            document.getElementById('word-english').textContent = currentWord.english;
            document.getElementById('word-bulgarian').textContent = '...';

            // Disable buttons
            document.getElementById('success-btn').disabled = true;
            document.getElementById('fail-btn').disabled = true;

            setTimeout(function() {
                document.getElementById('word-bulgarian').textContent = currentWord.bulgarian;
                // Enable buttons after reveal
                document.getElementById('success-btn').disabled = false;
                document.getElementById('fail-btn').disabled = false;
            }, 5000);
        }

        // Update accuracy display
        function updateAccuracy() {
            const percentage = totalAttempts > 0 ? Math.round((successes / totalAttempts) * 100) : 0;
            document.querySelector('.accuracy-display').textContent = `Accuracy: ${percentage}%`;
        }

        // Update failed words display
        function updateFailedWords() {
            const failedText = failedWords.map(word => `${word.bulgarian} - ${word.english}`).join('\n');
            document.getElementById('failed-words-list').value = failedText;
        }

        // Setup next button
        document.getElementById('next').addEventListener('click', showWord);

        // Setup success and fail buttons
        document.getElementById('success-btn').addEventListener('click', function() {
            successes++;
            totalAttempts++;
            updateAccuracy();
            this.disabled = true;
            document.getElementById('fail-btn').disabled = true;
        });

        document.getElementById('fail-btn').addEventListener('click', function() {
            if (currentWord) {
                failedWords.push(currentWord);
                updateFailedWords();
            }
            totalAttempts++;
            updateAccuracy();
            this.disabled = true;
            document.getElementById('success-btn').disabled = true;
        });

        document.getElementById('copy-failed-btn').addEventListener('click', function() {
            const textarea = document.getElementById('failed-words-list');
            textarea.select();
            document.execCommand('copy');
            alert('Failed words copied to clipboard!');
        });
    </script>
</body>
</html>
